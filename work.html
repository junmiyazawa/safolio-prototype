<!doctype html><html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Safolio — 作品詳細</title>
  <meta name="robots" content="index,follow,noai,noimageai">
  <link rel="stylesheet" href="styles.css?v=4">
</head>
<body oncontextmenu="return false;">
<header class="header">
  <div class="container inner">
    <div class="brand"><div class="logo"></div><strong>Safolio</strong><span class="small">Work</span></div>
    <nav class="nav">
      <a href="index.html">ホーム</a>
      <a href="portfolio.html">ポートフォリオ</a>
      <a href="faq.html">FAQ</a>
      <a href="contact.html">お問い合わせ</a>
    </nav>
  </div>
</header>

<main class="container">
  <section class="card" style="max-width:980px;margin:0 auto">
    <h2 id="workTitle" style="margin-top:0">作品</h2>
    <canvas id="wmCanvas" style="width:100%;border-radius:8px;border:1px solid #eee;max-height:70vh"></canvas>

    <div data-controls="wm" style="display:flex;gap:10px;flex-wrap:wrap;margin:12px 0">
      <button class="btn" id="wmToggle" type="button">透かしON</button>
      <a class="btn" id="shareBtn" href="#">限定公開リンクを生成</a>
      <a class="btn primary" id="inquiryBtn" href="#">依頼する</a>
      <a class="btn" id="reportBtn" href="#">不正利用を報告</a>
      <a class="btn" href="portfolio.html">一覧へ戻る</a>

      <select id="expirySel">
        <option value="1">1h</option>
        <option value="24" selected>24h</option>
        <option value="168">7d</option>
      </select>
      <select id="wmPos">
        <option value="br" selected>右下</option>
        <option value="bl">左下</option>
        <option value="tr">右上</option>
        <option value="tl">左上</option>
      </select>
      <span class="small">濃さ</span>
      <input type="range" id="wmAlpha" min="0.05" max="0.6" step="0.05" value="0.25" style="width:160px">
      <span class="small">サイズ</span>
      <input type="range" id="wmScale" min="0.02" max="0.08" step="0.005" value="0.035" style="width:160px">
    </div>

    <p class="small" id="status"></p>
  </section>
</main>

<footer class="footer"><div class="container">© 2025 Safolio.</div></footer>

<!-- 作品データ（works.js がある場合は読み込み） -->
<script src="works.js"></script>
<script>
  // ===== 透かし設定（ページ内で自己完結） =====
  const WM = { alpha: 0.25, scale: 0.035, pos: 'br' };
  let wmOn = false;

  // ===== 画像描画（透かし込み） =====
  function drawWithWatermark(src) {
    const canvas = document.getElementById('wmCanvas');
    const ctx = canvas.getContext('2d');
    const img = new Image();
    img.crossOrigin = 'anonymous';
    img.onload = () => {
      const maxW = canvas.clientWidth || 900;
      const ratio = img.height / img.width;
      const w = maxW, h = Math.round(w * ratio);
      canvas.width = w; canvas.height = h;
      ctx.clearRect(0,0,w,h);
      ctx.drawImage(img, 0, 0, w, h);
      if (wmOn) {
        ctx.globalAlpha = WM.alpha;
        ctx.font = Math.floor(w * WM.scale) + 'px sans-serif';
        ctx.fillStyle = '#2B4B7C';
        ctx.textAlign = (WM.pos.endsWith('r') ? 'right' : 'left');
